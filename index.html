<!DOCTYPE html>

<!--[if gt IE 9]><!--> <html lang="en"> <!--<![endif]-->

<head>

  <meta charset="utf-8">

  <title>Audacity Engine</title>

  <meta name="description" content="">
  <meta name="author" content="">
  <meta name="robots" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1.0">

  <!-- Favicons (just the basics for now, check out http://realfavicongenerator.net/ for all available) -->
  <link rel="shortcut icon" href="assets/img/favicon.png">
  <link rel="icon" type="image/png" href="assets/img/favicon.png" sizes="32x32">
  <!-- Web fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:200,300,400,600,700&Open+Sans:300,400,600,700">

  <!-- Bootstrap and Ares CSS -->
  <link rel="stylesheet" href="assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/css/animate.min.css">
  <link rel="stylesheet" href="assets/css/ares.css">

  <!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">

  <script src="https://unpkg.com/3d-force-graph"></script>
  <!-- Scripts -->
  <script src="assets/js/core/jquery.min.js"></script>
  <script src="assets/js/plugins/jquery.appear.min.js"></script>
  <script src="assets/js/plugins/jquery.countTo.min.js"></script>
  <script src="assets/js/plugins/jquery.easypiechart.min.js"></script>
  <script src="assets/js/ares.js"></script>
  <!--<script src="../../dist/3d-force-graph.js"></script>-->

  <style>
  .fullscreen {
  /* position: fixed; */
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
   overflow: auto;
  background: black; /* Just to visualize the extent */
}

.preview_window {
/* position: fixed; */
top: 20%;
left: 5%;
bottom: 20%;
right: 80%;
 overflow:hidden;
/* background: lime;  */
border:none;
}

.class_preview_frame {
  -ms-transform:scale(0.60);
-moz-transform:scale(0.60);
-o-transform: scale(0.60);
-webkit-transform: scale(0.60);
transform:scale(0.60);
border:1px solid black;
}

.toolbar {
  top: 5%;
  /* left: 80%; */
  /* bottom: 80%; */
  right: 5%;
  /* height:36px; */
   overflow:hidden;
  /* background: black; */
  /* opacity:50%; */
  border:none;
}

.right_panel {
  top: 0%;
  /* left: 80%; */
  /* bottom: 80%; */
  right: 0%;
   height:100%;
  width:20%;
   overflow:hidden;
background: gray;
   /* opacity:50%; */
  border:none;
}

.autocomplete {
  /*the container must be positioned relative:*/
  position: relative;
  display: inline-block;
}
input {
  border: 1px solid transparent;
  background-color: #f1f1f1;
  padding: 10px;
  font-size: 16px;
}
input[type=text] {
  background-color: #f1f1f1;
  width: 100%;
}
input[type=submit] {
  background-color: DodgerBlue;
  color: #fff;
}

.autocomplete-items {
  position: absolute;
  border: 1px solid #d4d4d4;
  border-bottom: none;
  border-top: none;
  z-index: 99;
  /*position the autocomplete items to be the same width as the container:*/
  top: 100%;
  left: 0;
  right: 0;
}
.autocomplete-items div {
  padding: 10px;
  cursor: pointer;
  background-color: #fff;
  border-bottom: 1px solid #d4d4d4;
}
.autocomplete-items div:hover {
  /*when hovering an item:*/
  background-color: #e9e9e9;
}
.autocomplete-active {
  /*when navigating through the items using the arrow keys:*/
  background-color: DodgerBlue !important;
  color: #ffffff;
}
 </style>
</head>

<body>

  <div class="fullscreen" style="z-index: 1; position: absolute;">
  <div id="3d-graph" ></div>
  </div>

  <!-- <div class = "preview_window" style="z-index: 2; position: absolute;">
    <iframe id="preview_frame" class="class_preview_frame" style="display:block; width:100%;height:100%;"> </iframe>
</div> -->

<div class="right_panel" style="z-index: 2; position: absolute;">
<div class="row justify-content-md-center" style="text-align:center;margin-top:5%;">
<div class = "toolbar">
  <button class="btn btn-lg" style="background:black;color:white;" title="Full Screen"><i class="fas fa-expand-arrows-alt"></i></button>
  <button class="btn btn-lg" style="background:black;color:white;" onclick="centerScreen()" title="Center Screen"><i class="fas fa-compress-arrows-alt"></i></button>
  <button class="btn btn-lg" style="background:black;color:white;" title="User Settings"><i class="fas fa-user-cog"></i></button>
  <button class="btn btn-lg" style="background:black;color:white;" title="Sign Out">  <i class="fas fa-sign-out-alt"></i></button>

  <!-- <button class="btn btn-lg" style="background:black;color:white;" onclick="centerScreen()" ><i class="fas fa-compress-arrows-alt"></i></button> -->
</div>
</div>
<hr>
<div class="row justify-content-md-center" style="text-align:center;color:black;margin-top:5%;">
  <form>
  <div class="form-group">
    <!-- <h3><span class="label label-default" style="text-align:center;color:black;">Search</span></h3> -->
  <!-- <label for="usr">Search</label> -->

    <div class="autocomplete" style="width:90%;">
        <span>
        <input id="input_search" type="text" class="form-control input-lg">
          <button class="btn" style="background:black;color:white;" title="Search">  <i class="fas fa-search"></i></button>
          </span>
</div>



</div>
</form>
</div>
<hr>
<div class="row justify-content-md-center" style="text-align:center;color:black;margin-top:5%;">
      <button class="btn" style="background:black;color:white;" title="Go to Page">  <i class="fas fa-external-link-square-alt"></i></button>
    <button class="btn" style="background:black;color:white;" title="Bookmark Page">   <i class="fas fa-bookmark"></i></button>
          <button class="btn" style="background:black;color:white;" title="Print Page"> <i class="fas fa-print"></i></button>
                <button class="btn" style="background:black;color:white;" title="Copy Page Link">   <i class="fas fa-bookmark"></i></button>
                <button class="btn" style="background:black;color:white;" title="Share Page Link"> <i class="fas fa-share-square"></i></button>

</div>
<br>
<div class="row justify-content-md-center" style="text-align:center;color:black;margin-top:5%;height:300px;display:none;" id="spinner">
    <img src="assets/img/spinner2.gif" alt="Loading Preview.." title="Loading Preview..">
</div>
<!-- <div class="row justify-content-md-center" style="text-align:center;color:black;height:60vh;margin:0;padding:0;border:0;"> -->
    <iframe id="preview_frame" class="row" style="position:absolute;display:block; width:100%;height:100%;border:0;margin:0;padding:0;" onload="document.getElementById('spinner').style.display='none';  document.getElementById('preview_frame').style.display = 'block';"> </iframe>
    <!-- </div> -->
</div>

  <script>
    // Random tree
    const N = 80;
    const gData = {
      nodes: [...Array(N).keys()].map(i => ({ id: i })),
      links: [...Array(N).keys()]
        .filter(id => id)
        .map(id => ({
          source: id,
          target: Math.round(Math.random() * (id-1))
        }))
    };

    // cross-link node objects
    gData.links.forEach(link => {
      const a = gData.nodes[link.source];
      const b = gData.nodes[link.target];
      !a.neighbors && (a.neighbors = []);
      !b.neighbors && (b.neighbors = []);
      a.neighbors.push(b);
      b.neighbors.push(a);

      !a.links && (a.links = []);
      !b.links && (b.links = []);
      a.links.push(link);
      b.links.push(link);
    });

    const highlightNodes = new Set();
    const highlightLinks = new Set();
    let hoverNode = null;

    const Graph = ForceGraph3D()
      (document.getElementById('3d-graph'))

  .jsonUrl('https://betterme.ai/audacitycommons/audacityengine/data/data_20201201.json')
  .nodeLabel('id')

    // .nodeAutoColorBy('color')

//If Node is not highlighted or there is no hover on Node, then default value of node color is taken
 .nodeColor(node => highlightNodes.has(node) ? node === hoverNode ? 'rgba(255,160,0,0.8)' : 'rgba(255,160,0,0.8)' : node.color)
    // .nodeColor('color')
        .linkWidth(link => highlightLinks.has(link) ? 4 : 1)
        .linkDirectionalParticles(link => highlightLinks.has(link) ? 4 : 0)
        .linkDirectionalParticleWidth(4)
        .onNodeHover(node => {
          // no state change
          if ((!node && !highlightNodes.size) || (node && hoverNode === node)) return;

          highlightNodes.clear();
          highlightLinks.clear();
          if (node) {
            highlightNodes.add(node);
            if (node.neighbours)
            node.neighbors.forEach(neighbor => highlightNodes.add(neighbor));
            if (node.links)
            node.links.forEach(link => highlightLinks.add(link));
          }

          hoverNode = node || null;

          updateHighlight();
        })
        .onNodeClick(node => {
         // Aim at node from outside it
         const distance = 40;
         const distRatio = 1 + distance/Math.hypot(node.x, node.y, node.z);

         Graph.cameraPosition(
           { x: node.x * distRatio, y: node.y * distRatio, z: node.z * distRatio }, // new position
           node, // lookAt ({ x, y, z })
           3000  // ms transition duration
         );


       })
       .onNodeRightClick(node => {
                  var frame = document.getElementById("preview_frame");
                  frame.style.display = "none";
                  document.getElementById("spinner").style.display="none";

         if (node.url == "") return;

document.getElementById("spinner").style.display="block";

         frame.src= node.url;
         // window.open(
         //      node.url,
         //      'preview_frame' // <- This is what makes it open in a new window.
         //    );
                   })
        .onLinkHover(link => {
          highlightNodes.clear();
          highlightLinks.clear();

          if (link) {
            highlightLinks.add(link);
            highlightNodes.add(link.source);
            highlightNodes.add(link.target);
          }

          updateHighlight();
        });

    function updateHighlight() {
      // trigger update of highlighted objects in scene
      Graph
        .nodeColor(Graph.nodeColor())
        .linkWidth(Graph.linkWidth())
        .linkDirectionalParticles(Graph.linkDirectionalParticles());
    }

Graph.onEngineStop(() => Graph.zoomToFit(400));

function centerScreen() {
    // fit to canvas when engine stops
Graph.onEngineStop(() => Graph.zoomToFit(400));
}

$(document).ready(function(){
  searchtopics = ["Slice","Farm to Fork","Micro Factory","Human Flourishing","SHEA","Movable","Structure","Humans","Future Business Innovation (JTC)","__Org Template","JTC","ADDO AI","Affect-tag","AffordAble Abodes","ALH & A Studio","Arup","Aufhaven","Augmenta Inc.","Bahrain Authority for Culture and Antiquities","BCG","Benoy Limited","Brunch Bandits","Buckminster Fuller Institute","Build Academy", "Capgemini","Catalyst Opportunity Zone Impact Fund","Center for Advanced Hindsight","Centre for Conscious Design","Centre for Urban Design and Mental Health","CoMotion LA & Miami","CoPlace","Critical Media Lab","Cullinan Studio","Custo","Deloitte Center for the Edge","Design Singapore Council","Digital Blue Foam","EcoLabs Centre of Innovation for Energy","Ecotek","Emerging Transport Advisors","Energy Research Institute NTU","ESSEC Business Schol","Fortitude Culina","ETH Future Cities Lab","ETH Zurich","Except Integrated Sustainability","Experimentalista","ExtraBold R&D","Fig and Blossom", "Foundation for Futuristic Cities","Future Cities Laboratory","Future of Cities ","FutureMap","Game Solutions Lab","Good City Foundation ","Gray Area","Hadaen","Hanakata","Happy City","Hsu + Friends","Resilient Cities Network","Mistletoe","Sampo","MIT Media Lab Persuasive Cities","Transforms.me","Zeltini","Neeuro","Weijenberg","The Embassy of Peace","Ramboll","MAKE Studios","LOPELAB","Mindfi","Luleå University of Technology", "National University of Singapore","Well to Work","Niantic","IDEO CoLab","Universidad Anáhuac Puebla","New Cities Foundation","Jam3","Regen Viillages","Neuromore","Tau Research and Development","Nonfiction","New Mindfulness","Inlighten.io","University of Toronto","Re:Imagine Group","Lighthouse.one","Maker City","Riken CBS","MIT Department of Urban Studies and Planning","Our Aura Grp","Hume","SFPL","Nanyang Business School","MIT School of Architecture & Planning","The Science Project", "Imaginary Friends","New York University","The Design Futures ","Stanford University School of Medicine","Stanford University Human Flourishing Project","Project Shea","SingularityNET","Tech4America","uHoo","UPMC Health Plan","Stage 6","Institute for the Future","JLL - Jones Lang LaSalle Property Consultants Pte Ltd","McKinsey & Co","Xische","LUMAN","Urban Arts Collective ","The Bartlett School of Architecture","Storpweber Architecture","TVS Motors","Kohn Pedersen Fox Associates","Moonshop Gallery Sdn Bhd","NEOTROPE SAS","Stanford University","Singularity University", "Transformative Technology Lab","Singapore Heavy Engineering","Fortitude Culina","Binjai Brew","IIM","Insect Feed Technologies","Renergii Asia","Alesca Life","Namz","Insectta","Innovate360","Big Idea Ventures","Classic Fine Foods","Sophie's Bionutrients","Green Monday","Spectronik","Canopy Power","Morethanveggies","Singapore Polytechnic","Copy of Tech4America"];
  console.log (searchtopics);
 autocomplete(document.getElementById("input_search"), searchtopics);
});

// function find_node()
// {
//
//   var node_id = document.getElementById("input_search").value;
//
//   var nodes = Graph.nodes;
//   // Aim at node from outside it
//   const distance = 40;
//   const distRatio = 1 + distance/Math.hypot(node.x, node.y, node.z);
//
//   Graph.cameraPosition(
//     { x: node.x * distRatio, y: node.y * distRatio, z: node.z * distRatio }, // new position
//     node, // lookAt ({ x, y, z })
//     3000  // ms transition duration
//   );
// }


function autocomplete(inp, arr) {
  /*the autocomplete function takes two arguments,
  the text field element and an array of possible autocompleted values:*/
  var currentFocus;
  /*execute a function when someone writes in the text field:*/
  inp.addEventListener("input", function(e) {
      var a, b, i, val = this.value;
      /*close any already open lists of autocompleted values*/
      closeAllLists();
      if (!val) { return false;}
      currentFocus = -1;
      /*create a DIV element that will contain the items (values):*/
      a = document.createElement("DIV");
      a.setAttribute("id", this.id + "autocomplete-list");
      a.setAttribute("class", "autocomplete-items");
      /*append the DIV element as a child of the autocomplete container:*/
      this.parentNode.appendChild(a);
      /*for each item in the array...*/
      for (i = 0; i < arr.length; i++) {
        /*check if the item starts with the same letters as the text field value:*/
        if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
          /*create a DIV element for each matching element:*/
          b = document.createElement("DIV");
          /*make the matching letters bold:*/
          b.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
          b.innerHTML += arr[i].substr(val.length);
          /*insert a input field that will hold the current array item's value:*/
          b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
          /*execute a function when someone clicks on the item value (DIV element):*/
              b.addEventListener("click", function(e) {
              /*insert the value for the autocomplete text field:*/
              inp.value = this.getElementsByTagName("input")[0].value;
              /*close the list of autocompleted values,
              (or any other open lists of autocompleted values:*/
              closeAllLists();
          });
          a.appendChild(b);
        }
      }
  });
  /*execute a function presses a key on the keyboard:*/
  inp.addEventListener("keydown", function(e) {
      var x = document.getElementById(this.id + "autocomplete-list");
      if (x) x = x.getElementsByTagName("div");
      if (e.keyCode == 40) {
        /*If the arrow DOWN key is pressed,
        increase the currentFocus variable:*/
        currentFocus++;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 38) { //up
        /*If the arrow UP key is pressed,
        decrease the currentFocus variable:*/
        currentFocus--;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 13) {
        /*If the ENTER key is pressed, prevent the form from being submitted,*/
        e.preventDefault();
        if (currentFocus > -1) {
          /*and simulate a click on the "active" item:*/
          if (x) x[currentFocus].click();
        }
      }
  });
  function addActive(x) {
    /*a function to classify an item as "active":*/
    if (!x) return false;
    /*start by removing the "active" class on all items:*/
    removeActive(x);
    if (currentFocus >= x.length) currentFocus = 0;
    if (currentFocus < 0) currentFocus = (x.length - 1);
    /*add class "autocomplete-active":*/
    x[currentFocus].classList.add("autocomplete-active");
  }
  function removeActive(x) {
    /*a function to remove the "active" class from all autocomplete items:*/
    for (var i = 0; i < x.length; i++) {
      x[i].classList.remove("autocomplete-active");
    }
  }
  function closeAllLists(elmnt) {
    /*close all autocomplete lists in the document,
    except the one passed as an argument:*/
    var x = document.getElementsByClassName("autocomplete-items");
    for (var i = 0; i < x.length; i++) {
      if (elmnt != x[i] && elmnt != inp) {
      x[i].parentNode.removeChild(x[i]);
    }
  }
}
/*execute a function when someone clicks in the document:*/
document.addEventListener("click", function (e) {
    closeAllLists(e.target);
});
}
  </script>
</body>
</html>
